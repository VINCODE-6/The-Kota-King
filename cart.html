<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart â€“ The Kota King</title>
    <link rel="stylesheet" href="kotaking.css">
</head>
<body>

    <header id="main-header">
        <div class="inner-container">
            <h1>THE KOTA KING</h1>
            <div class="header-logo">
                <img src="images/logo.png" alt="Kota King Logo">
            </div>
            <nav class="navbar">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="menu.html">Menu</a></li>
                    <li><a href="cart.html" class="active">Cart <span id="cart-count-header">0</span></a></li>
                    <li><a href="locations.html">Locations</a></li>
                    <li><a href="coupons.html">Coupons</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="cart-page">
        <h2 class="section-title">Your Cart</h2>

        <div id="cart-items-container"></div>

        <div class="cart-summary" id="cart-summary-block" style="display:none;">
            <div id="cart-lines-summary"></div>
            <div class="cart-summary-row">
                <span>Total items</span>
                <span id="cart-total-qty">0</span>
            </div>
            <div class="cart-total-row">
                <span class="label">Total</span>
                <span class="amount">R <span id="cart-total">0.00</span></span>
            </div>
            <button class="checkout-btn" id="whatsapp-checkout-btn">
                ðŸ›’ Send Order via WhatsApp
            </button>
            <button class="order-btn" onclick="clearCart(); renderCart();"
                style="background:#eee; color:#c62828; margin-top:0.8rem; width:100%; font-size:0.95rem; padding:10px;">
                Clear Cart
            </button>
        </div>

        <div id="empty-cart-message" class="empty-cart-message" style="display:none;">
            <p>Your cart is empty.</p>
            <p><a href="menu.html">Browse the menu</a> and add some kotas!</p>
        </div>
    </main>

    <footer id="main-footer">
        <p><strong>THE KOTA KING</strong> â€“ Hot &amp; Fresh Every Time</p>
        <div class="footer-links">
            <a href="contact.html">Contact</a>
            <span class="footer-sep">â€¢</span>
            <a href="locations.html">Find Us</a>
            <span class="footer-sep">â€¢</span>
            <a href="https://wa.me/123456789" target="_blank" title="WhatsApp Us">
                <svg class="footer-wa-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
            </a>
        </div>
        <p style="margin-top:1rem; opacity:0.7; font-size:0.9rem;">Â© 2025 KOTA KING â€“ Made with pride in Cape Town</p>
    </footer>

    <script src="kotaking.js"></script>
    <script>
        function renderCart() {
            const container  = document.getElementById('cart-items-container');
            const summary    = document.getElementById('cart-summary-block');
            const emptyMsg   = document.getElementById('empty-cart-message');
            const totalEl    = document.getElementById('cart-total');
            const totalQtyEl = document.getElementById('cart-total-qty');
            const linesEl    = document.getElementById('cart-lines-summary');

            if (cart.length === 0) {
                container.innerHTML = '';
                summary.style.display  = 'none';
                emptyMsg.style.display = 'block';
                return;
            }

            emptyMsg.style.display = 'none';
            summary.style.display  = 'block';

            let html = '';
            let grandTotal = 0;
            let totalQty   = 0;
            let linesHtml  = '';

            cart.forEach(item => {
                const lineTotal = item.price * item.quantity;
                grandTotal += lineTotal;
                totalQty   += item.quantity;

                linesHtml += `
                <div class="cart-summary-row">
                    <span>${item.name} Ã— ${item.quantity}</span>
                    <span>R${lineTotal.toFixed(2)}</span>
                </div>`;

                html += `
                <div class="cart-item">
                    <div class="item-info">
                        <strong>${item.name}</strong>
                        <span class="item-meta">R${item.price.toFixed(2)} each &nbsp;|&nbsp; Qty: ${item.quantity}</span>
                    </div>
                    <div class="cart-item-controls">
                        <span class="line-total">R${lineTotal.toFixed(2)}</span>
                        <button class="qty-btn" onclick="decreaseQuantity('${item.id}')">âˆ’</button>
                        <button class="qty-btn" onclick="increaseQuantity('${item.id}')">+</button>
                        <button class="remove-btn" onclick="removeItem('${item.id}')">Ã—</button>
                    </div>
                </div>`;
            });

            container.innerHTML  = html;
            linesEl.innerHTML    = linesHtml;
            totalEl.textContent  = grandTotal.toFixed(2);
            totalQtyEl.textContent = totalQty;
        }

        document.getElementById('whatsapp-checkout-btn').addEventListener('click', function () {
            if (cart.length === 0) return;
            let msg = "Hello Kota King! I'd like to place this order:\n\n";
            let total = 0;
            cart.forEach((item, i) => {
                const sub = item.price * item.quantity;
                total += sub;
                msg += `${i + 1}. ${item.name} Ã— ${item.quantity} = R${sub.toFixed(2)}\n`;
            });
            msg += `\nTotal: R${total.toFixed(2)}\n\nThank you!`;
            window.open(`https://wa.me/123456789?text=${encodeURIComponent(msg)}`, '_blank');
        });

        document.addEventListener('DOMContentLoaded', renderCart);
    </script>

</body>
</html>
